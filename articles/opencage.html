<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='"Get started with the opencage R package to geocode with the OpenCage API, either from place name to longitude and latitude (forward geocoding) or from longitude and latitude to the name and address of a location (reverse geocoding)."
'>
<title>Introduction to opencage • opencage</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to opencage">
<meta property="og:description" content='"Get started with the opencage R package to geocode with the OpenCage API, either from place name to longitude and latitude (forward geocoding) or from longitude and latitude to the name and address of a location (reverse geocoding)."
'>
<meta property="og:image" content="https://docs.ropensci.org/opencage/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">opencage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/opencage.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/customise_query.html">Customise your query</a>
    <a class="dropdown-item" href="../articles/output_options.html">Output options</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/opencage/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to opencage</h1>
            <h3 data-toc-skip class="subtitle">Forward and Reverse Geocoding</h3>
                        <h4 data-toc-skip class="author">Daniel Possenriede, Jesse Sadler, Maëlle Salmon</h4>
            
            <h4 data-toc-skip class="date">2022-09-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/opencage/blob/HEAD/vignettes/opencage.Rmd" class="external-link"><code>vignettes/opencage.Rmd</code></a></small>
      <div class="d-none name"><code>opencage.Rmd</code></div>
    </div>

    
    
<p>Geocoding is the process of converting place names or addresses into geographic coordinates – like latitude and longitude – or vice versa. With {opencage} you can geocode using the OpenCage API, either from place name to longitude and latitude (forward geocoding) or from longitude and latitude to the name and address of a location (reverse geocoding).</p>
<p>This vignette covers the setup process for working with {opencage} and basic workflows for both forward and reverse geocoding. Make sure to also check out “<a href="customise_query.html">Customise your query</a>” if you want a deeper dive into customizing the various parameters available through the OpenCage API. The “<a href="output_options.html">Output options</a>” vignette shows additional workflows by modifying the form in which the geocoding results are returned.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Before you can use the {opencage} package and query the OpenCage API you need to first register with OpenCage. Additionally, you may want to set a rate limit (if you have a paid <a href="https://opencagedata.com/pricing" class="external-link">OpenCage plan</a>), and you might want to prevent OpenCage from storing the content of your queries. In other words, you need to setup {opencage}, so let’s go through the process.</p>
<div class="section level3">
<h3 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h3>
<p>To use the package and authenticate yourself with the OpenCage API, you will need to register at <a href="https://opencagedata.com/users/sign_up" class="external-link">opencagedata.com/users/sign_up</a> to get an API key. The “Free Trial” plan provides up to 2,500 API requests a day. There are paid plans available, if you need to run more API requests. After you have registered, you can generate an API key with the <a href="https://opencagedata.com/dashboard#api-keys" class="external-link">OpenCage dashboard</a>.</p>
<p>Now we need to ensure that the functions in {opencage} can access your API key. {opencage} will conveniently retrieve your API key if it is saved in the environment variable <code>"OPENCAGE_KEY"</code>. If it is not, <code><a href="../reference/oc_config.html">oc_config()</a></code> will help to set that environment variable.</p>
<p>Do not pass the key directly as a parameter to the function. Doing so risks exposing your API key via your script or your history. There are three safer ways to set your API key instead:</p>
<ol style="list-style-type: decimal">
<li><p>Save your API key as an environment variable in <code>.Renviron</code> as described in <a href="https://rstats.wtf/r-startup.html#renviron" class="external-link">What They Forgot to Teach You About R</a> or <a href="https://csgillespie.github.io/efficientR/set-up.html#renviron" class="external-link">Efficient R Programming</a>. From there it will be fetched by all functions that call the OpenCage API. You do not even have to call <code><a href="../reference/oc_config.html">oc_config()</a></code> to set your key; you can start geocoding right away. If you have the {<a href="https://usethis.r-lib.org" class="external-link">usethis</a>} package installed, you can edit your <code>.Renviron</code> with <code>usethis::edit_r_environ()</code>. We strongly recommend storing your API key in the user-level <code>.Renviron</code>, as opposed to the project-level. This makes it less likely you will share sensitive information by mistake.</p></li>
<li><p>If you use a package like {<a href="https://github.com/r-lib/keyring" class="external-link">keyring</a>} to store your credentials, you can safely pass your key in a script with a function call like <code>oc_config(key = keyring::key_get("opencage"))</code>.</p></li>
<li><p>If you call <code><a href="../reference/oc_config.html">oc_config()</a></code> in an <code><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive()</a></code> session and the <code>OPENCAGE_KEY</code> environment variable is not set, it will prompt you to enter the key in the console.</p></li>
</ol>
<p>Whatever method you choose, keep your API key secret. OpenCage also features <a href="https://opencagedata.com/guides/how-to-protect-your-api-key" class="external-link">best practices for keeping your API key safe</a>.</p>
</div>
<div class="section level3">
<h3 id="rate-limit">Rate limit<a class="anchor" aria-label="anchor" href="#rate-limit"></a>
</h3>
<p>A rate limit is used to control the rate of requests sent, so legitimate requests do not lead to an unintended Denial of Service attack. The rate limit allowed by the API depends on the OpenCage plan you have and ranges from 1 request/sec for the “Free Trial” plan to 40 requests/sec for “Large” plan. See <a href="https://opencagedata.com/pricing" class="external-link">opencagedata.com/pricing</a> for details and up-to-date information.</p>
<p>If you have a “Free Trial” account with OpenCage, you can skip to the next section, because the rate limit is already set correctly for you at 1 request/sec.</p>
<p>If you have a paid account, you can set the rate limit for the active R session with <code>oc_config(rate_sec = n)</code> where <code>n</code> is the appropriate rate limit. You can set the rate limit persistently across sessions by setting an <code>oc_rate_sec</code> option in your <code>.Rprofile</code>. If you have the {<a href="https://usethis.r-lib.org" class="external-link">usethis</a>} package installed, you can edit your <code>.Rprofile</code> with <code>usethis::edit_r_profile()</code>.</p>
</div>
<div class="section level3">
<h3 id="privacy">Privacy<a class="anchor" aria-label="anchor" href="#privacy"></a>
</h3>
<p>By default, OpenCage will store your queries on its server logs and will cache the forward geocoding requests on their side. They do this to speed up response times and to be able to debug errors and improve their service. Logs are automatically deleted after six months according to OpenCage’s <a href="https://opencagedata.com/gdpr" class="external-link">page on data protection and GDPR</a>.</p>
<p>If you have concerns about privacy and want OpenCage to have no record of your query, i.e. the place name or latitude and longitude coordinates you want to geocode, you can set a <code>no_record</code> parameter to <code>TRUE</code>, which tells the API to not log nor cache the queries. OpenCage still records that you made a request, but not the specific queries you made.</p>
<p><code>oc_config(no_record = TRUE)</code> sets an <code>oc_no_record</code> option for the active R session, so it will be used for all subsequent OpenCage queries. You can set the <code>oc_no_record</code> option persistently across sessions in your <code>.Rprofile</code>.</p>
<p>For more information on OpenCage’s policies on privacy and data protection see the Legal section in <a href="https://opencagedata.com/faq#legal" class="external-link">their FAQs</a>, their <a href="https://opencagedata.com/gdpr" class="external-link">GDPR page</a>, and, for the <code>no_record</code> parameter specifically, see the relevant <a href="https://blog.opencagedata.com/post/145602604628/more-privacy-with-norecord-parameter" class="external-link">blog post</a>.</p>
<p>For increased privacy, {opencage} sets <code>no_record</code> to <code>TRUE</code>, by default. Please note, however, that {opencage} always caches the data it receives from the OpenCage API locally, but only for as long as your R session is alive (see below).</p>
</div>
<div class="section level3">
<h3 id="dont-show-api-key">(Don’t) show API key<a class="anchor" aria-label="anchor" href="#dont-show-api-key"></a>
</h3>
<p><code><a href="../reference/oc_config.html">oc_config()</a></code> has another argument, <code>show_key</code>. This is only used for debugging and we will explain it in more detail in <code><a href="../articles/output_options.html">vignette("output_options")</a></code>. For now suffice it to say that your OpenCage API key will not be shown in any {opencage} output, unless you change this setting.</p>
</div>
<div class="section level3">
<h3 id="altogether-now">Altogether now<a class="anchor" aria-label="anchor" href="#altogether-now"></a>
</h3>
<p>In sum, if you want to set your API key with {keyring}, set the rate limit to 10 (only do this if you have a paid account, please!), and do not want OpenCage to have records of your queries, you would configure {opencage} for the active session like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/opencage/">"opencage"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/oc_config.html">oc_config</a></span><span class="op">(</span></span>
<span>  key <span class="op">=</span> <span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_get</span><span class="op">(</span><span class="st">"opencage"</span><span class="op">)</span>,</span>
<span>  rate_sec <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  no_record <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="forward-geocoding">Forward geocoding<a class="anchor" aria-label="anchor" href="#forward-geocoding"></a>
</h2>
<p>Now you can start to geocode. Forward geocoding is from location name(s) to latitude and longitude tuple(s).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/oc_forward_df.html">oc_forward_df</a></span><span class="op">(</span>placename <span class="op">=</span> <span class="st">"Sarzeau"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;   placename oc_lat oc_lng oc_formatted         </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                </span></span>
<span><span class="co">#&gt; 1 Sarzeau     47.5  -2.76 56370 Sarzeau, France</span></span></code></pre></div>
<p>All geocoding functions are vectorised, i.e. you can geocode multiple locations with one function call. Note that behind the scenes the requests are still sent to the API one-by-one.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opera</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Palacio de Bellas Artes"</span>, <span class="st">"Scala"</span>, <span class="st">"Sydney Opera House"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/oc_forward_df.html">oc_forward_df</a></span><span class="op">(</span>placename <span class="op">=</span> <span class="va">opera</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   placename               oc_lat oc_lng oc_formatted                                                              </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                                                                     </span></span>
<span><span class="co">#&gt; 1 Palacio de Bellas Artes   19.4  -99.1 Palacio de Bellas Artes, Avenida Juárez, Centro Urbano, 06050, CMX, Mexico</span></span>
<span><span class="co">#&gt; 2 Scala                     40.7   14.6 Scala, Salerno, Italy                                                     </span></span>
<span><span class="co">#&gt; 3 Sydney Opera House       -33.9  151.  Sydney Opera House, 2 Macquarie Street, Sydney NSW 2000, Australia</span></span></code></pre></div>
<p>By default, <code><a href="../reference/oc_forward_df.html">oc_forward_df()</a></code> only returns three results columns: <code>oc_lat</code> (for latitude), <code>oc_lon</code> (for longitude), and <code>oc_formatted</code> (the formatted address). As you can see, the results columns are all prefixed with <code>oc_</code>. If you specify <code>oc_forward_df(output = all)</code>, you will receive all result columns, which are often quite extensive. Which columns you receive exactly depends on the information OpenCage returns for each specific request.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/oc_forward_df.html">oc_forward_df</a></span><span class="op">(</span>placename <span class="op">=</span> <span class="va">opera</span>, output <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 31</span></span>
<span><span class="co">#&gt;   placename     oc_lat oc_lng oc_co…¹ oc_fo…² oc_no…³ oc_no…⁴ oc_so…⁵ oc_so…⁶ oc_is…⁷ oc_is…⁸ oc_is…⁹ oc_ca…˟ oc_type oc_co…˟</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;list&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1 Palacio de B…   19.4  -99.1       9 Palaci…    19.4   -99.1    19.4   -99.1 MX      MEX     &lt;chr&gt;   outdoo… museum  North …</span></span>
<span><span class="co">#&gt; 2 Scala           40.7   14.6       7 Scala,…    40.7    14.6    40.6    14.6 IT      ITA     &lt;chr&gt;   place   city    Europe </span></span>
<span><span class="co">#&gt; 3 Sydney Opera…  -33.9  151.        9 Sydney…   -33.9   151.    -33.9   151.  AU      AUS     &lt;chr&gt;   outdoo… arts_c… Oceania</span></span>
<span><span class="co">#&gt; # … with 16 more variables: oc_country &lt;chr&gt;, oc_country_code &lt;chr&gt;, oc_museum &lt;chr&gt;, oc_neighbourhood &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   oc_postcode &lt;chr&gt;, oc_road &lt;chr&gt;, oc_state &lt;chr&gt;, oc_state_code &lt;chr&gt;, oc_city &lt;chr&gt;, oc_county &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   oc_county_code &lt;chr&gt;, oc_political_union &lt;chr&gt;, oc_arts_centre &lt;chr&gt;, oc_house_number &lt;chr&gt;, oc_municipality &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   oc_suburb &lt;chr&gt;, and abbreviated variable names ¹​oc_confidence, ²​oc_formatted, ³​oc_northeast_lat, ⁴​oc_northeast_lng,</span></span>
<span><span class="co">#&gt; #   ⁵​oc_southwest_lat, ⁶​oc_southwest_lng, ⁷​oc_iso_3166_1_alpha_2, ⁸​oc_iso_3166_1_alpha_3, ⁹​oc_iso_3166_2, ˟​oc_category,</span></span>
<span><span class="co">#&gt; #   ˟​oc_continent</span></span></code></pre></div>
<p>You can also pass a data frame to <code><a href="../reference/oc_forward_df.html">oc_forward_df()</a></code>. By default the results columns are added to the input data frame, which is useful for keeping information associated with the place names that are in separate columns. If you want a data frame with only the geocoding results, set <code>bind_cols = FALSE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">concert_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Elbphilharmonie"</span>, <span class="st">"Concertgebouw"</span>, <span class="st">"Suntory Hall"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/oc_forward_df.html">oc_forward_df</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">concert_df</span>, placename <span class="op">=</span> <span class="va">location</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   location        oc_lat oc_lng oc_formatted                                                                 </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                                                                        </span></span>
<span><span class="co">#&gt; 1 Elbphilharmonie   53.5   9.98 Elbe Philharmonic Hall, Platz der Deutschen Einheit 1, 20457 Hamburg, Germany</span></span>
<span><span class="co">#&gt; 2 Concertgebouw     52.4   4.88 Concertgebouw, Concertgebouwplein 2, 1071 LN Amsterdam, Netherlands          </span></span>
<span><span class="co">#&gt; 3 Suntory Hall      35.7 140.   Suntory Hall, Karayan Plaza, Azabu, Minato, 107-6090, Japan</span></span></code></pre></div>
<p>You can use it in a piped workflow as well.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">concert_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/oc_forward_df.html">oc_forward_df</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   location        oc_lat oc_lng oc_formatted                                                                 </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                                                                        </span></span>
<span><span class="co">#&gt; 1 Elbphilharmonie   53.5   9.98 Elbe Philharmonic Hall, Platz der Deutschen Einheit 1, 20457 Hamburg, Germany</span></span>
<span><span class="co">#&gt; 2 Concertgebouw     52.4   4.88 Concertgebouw, Concertgebouwplein 2, 1071 LN Amsterdam, Netherlands          </span></span>
<span><span class="co">#&gt; 3 Suntory Hall      35.7 140.   Suntory Hall, Karayan Plaza, Azabu, Minato, 107-6090, Japan</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reverse-geocoding">Reverse geocoding<a class="anchor" aria-label="anchor" href="#reverse-geocoding"></a>
</h2>
<p>Reverse geocoding works in the opposite direction of forward geocoding: from a pair of coordinates to the name and address most appropriate for the coordinates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/oc_reverse_df.html">oc_reverse_df</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">51.5034070</span>, longitude <span class="op">=</span> <span class="op">-</span><span class="fl">0.1275920</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;   latitude longitude oc_formatted                                       </span></span>
<span><span class="co">#&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                                              </span></span>
<span><span class="co">#&gt; 1     51.5    -0.128 10 Downing Street, London, SW1A 2AA, United Kingdom</span></span></code></pre></div>
<p>Note that all coordinates sent to the OpenCage API must adhere to the <a href="https://en.wikipedia.org/wiki/World_Geodetic_System" class="external-link">WGS 84</a> (also known as <a href="https://epsg.io/4326" class="external-link">EPSG:4326</a>) <a href="https://en.wikipedia.org/wiki/Spatial_reference_system" class="external-link">coordinate reference system</a> in decimal format. This is the coordinate reference system used by the <a href="https://en.wikipedia.org/wiki/Global_Positioning_System" class="external-link">Global Positioning System</a>. There is usually no reason to send more than six or seven digits past the decimal. Any further precision gets to the <a href="https://en.wikipedia.org/wiki/Decimal_degrees" class="external-link">level of a centimeter</a>.</p>
<p>Like <code><a href="../reference/oc_forward_df.html">oc_forward_df()</a></code>, <code><a href="../reference/oc_reverse_df.html">oc_reverse_df()</a></code> is vectorised, can work with numeric vectors and data frames, supports the <code>output = "all"</code> argument and can be used with the {magrittr} pipe.</p>
<p>OpenCage only returns at most <a href="https://opencagedata.com/api#ranking" class="external-link">one result</a> per reverse geocoding request.</p>
</div>
<div class="section level2">
<h2 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a>
</h2>
<p>OpenCage <a href="https://opencagedata.com/api#caching" class="external-link">allows and supports caching</a>. To minimize the number of requests sent to the API {opencage} uses {<a href="https://github.com/r-lib/memoise" class="external-link">memoise</a>} to cache results inside the active R session.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/oc_reverse.html">oc_reverse</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">10</span>, longitude <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.00    0.00    0.96</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/oc_reverse.html">oc_reverse</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">10</span>, longitude <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.01    0.00    0.02</span></span></code></pre></div>
<p>To clear the cache of all results either start a new R session or call <code><a href="../reference/oc_clear_cache.html">oc_clear_cache()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/oc_clear_cache.html">oc_clear_cache</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/oc_reverse.html">oc_reverse</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">10</span>, longitude <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.01    0.00    0.91</span></span></code></pre></div>
<p>As you probably know, cache invalidation is one of the harder things to do in computer science. Therefore {opencage} only supports invalidating the whole cache and not individual records at the moment.</p>
<p>The underlying data at OpenCage is <a href="https://opencagedata.com/faq#general" class="external-link">updated daily</a>.</p>
</div>
<div class="section level2">
<h2 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p>OpenCage supports a lot of parameters to either target your search area more specifically or to specify what additional information you need. See the <a href="customise_query.html">“Customise your query”</a> vignette for details.</p>
<p>Besides <code><a href="../reference/oc_forward_df.html">oc_forward_df()</a></code> and <code><a href="../reference/oc_reverse_df.html">oc_reverse_df()</a></code>, which always return a single tibble, {opencage} has two sibling functions — <code><a href="../reference/oc_forward.html">oc_forward()</a></code> and <code><a href="../reference/oc_reverse.html">oc_reverse()</a></code> — which can be used to return types of output. Depending on what you specify as the <code>return</code> parameter, <code><a href="../reference/oc_forward.html">oc_forward()</a></code> and <code><a href="../reference/oc_reverse.html">oc_reverse()</a></code> will return either a list of tibbles (<code>df_list</code>, the default), JSON lists (<code>json_list</code>), GeoJSON lists (<code>geojson_list</code>), or the URL with which the API would be called (<code>url_only</code>). Learn more in the <a href="output_options.html">“Output options”</a> vignette.</p>
<p>Please report any issues or bugs on <a href="https://github.com/ropensci/opencage/issues" class="external-link">our GitHub repository</a> and post questions on <a href="https://discuss.ropensci.org" class="external-link">discuss.ropensci.org</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
